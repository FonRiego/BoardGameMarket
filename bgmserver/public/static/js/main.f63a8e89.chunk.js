(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{189:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(19),o=a.n(l),s=(a(51),a(3)),i=a(5),c=a(7),u=a(6),m=a(8),h=a(193),d=a(191),f=a(194),p=a(22),b=a(4),v=a(34),E=a.n(v),g=function e(){var t=this;Object(s.a)(this,e),this.signup=function(e,a){return t.service.post("/signup",{username:e,password:a}).then(function(e){return e.data})},this.login=function(e,a){return t.service.post("/login",{username:e,password:a}).then(function(e){return e.data})},this.loggedin=function(){return t.service.get("/currentUser").then(function(e){return e.data})},this.logout=function(){return t.service.get("/logout").then(function(e){return e.data})},this.service=E.a.create({baseURL:"".concat("https://board-game-market.herokuapp.com/api","/auth"),withCredentials:!0})},w=a(190),I=a(2),N=a.n(I),j=a(17),y=a.n(j),S=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleFormSubmit=function(e){e.preventDefault();var t=a.state.username,n=a.state.password;a.service.signup(t,n).then(function(e){a.setState({username:"",password:""}),a.props.getUser(e.user)}).then(function(){a.props.history.push("/profile")}).catch(function(e){return alert(e)})},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(p.a)({},n,r))},a.state={username:"",password:"",show:!0},a.service=new g,a.handleShow=a.handleShow.bind(Object(b.a)(Object(b.a)(a))),a.handleClose=a.handleClose.bind(Object(b.a)(Object(b.a)(a))),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"handleClose",value:function(){this.setState({show:!1}),this.props.history.push("/")}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(N.a,{show:this.state.show,onHide:this.handleClose,className:"modal-main",bsSize:"large"},r.a.createElement(N.a.Header,{className:"modal-header-footer",closeButton:!0},r.a.createElement(N.a.Title,{className:"modal-header-text"},"Crea una nueva cuenta")),r.a.createElement(N.a.Body,{className:"modal-body"},r.a.createElement("div",null,r.a.createElement("form",{className:"modal-body",onSubmit:this.handleFormSubmit},r.a.createElement("fieldset",null,r.a.createElement("label",null,"Nombre de usuario:"),r.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("fieldset",null,r.a.createElement("label",null,"Contrase\xf1a:"),r.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("input",{type:"submit",value:"Reg\xedstrate"}),r.a.createElement(w.a,{to:"/login"},r.a.createElement("button",{className:"modal-button"},"O Inicia sesi\xf3n"))))),r.a.createElement(N.a.Footer,{className:"modal-header-footer"},r.a.createElement(y.a,{className:"modal-button",onClick:this.handleClose},"Cerrar"))))}}]),t}(r.a.Component),C=Object(f.a)(S),O=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleFormSubmit=function(e){e.preventDefault();var t=a.state.username,n=a.state.password;a.service.login(t,n).then(function(e){a.setState({username:t,password:n,error:!1}),a.props.getUser(e)}).catch(function(e){a.setState({username:t,password:n,error:!0})}),a.props.history.push("/profile")},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(p.a)({},n,r))},a.state={username:"",password:"",show:!0},a.service=new g,a.handleShow=a.handleShow.bind(Object(b.a)(Object(b.a)(a))),a.handleClose=a.handleClose.bind(Object(b.a)(Object(b.a)(a))),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"handleClose",value:function(){this.setState({show:!1}),this.props.history.push("/")}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(N.a,{show:this.state.show,onHide:this.handleClose,className:"modal-main",bsSize:"large"},r.a.createElement(N.a.Header,{className:"modal-header-footer",closeButton:!0},r.a.createElement(N.a.Title,{className:"modal-header-text"},"Inicia tu sesi\xf3n")),r.a.createElement(N.a.Body,{className:"modal-body"},r.a.createElement("div",null,r.a.createElement("form",{className:"modal-body",onSubmit:this.handleFormSubmit},r.a.createElement("fieldset",null,r.a.createElement("label",null,"Nombre de usuario:"),r.a.createElement("input",{type:"text",name:"username",value:this.state.username,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("fieldset",null,r.a.createElement("label",null,"Contrase\xf1a:"),r.a.createElement("input",{type:"password",name:"password",value:this.state.password,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("input",{type:"submit",value:"Inicia Sesi\xf3n"}),r.a.createElement(w.a,{to:"/signup"},r.a.createElement("button",{className:"modal-button"},"O Reg\xedstrate"))))),r.a.createElement(N.a.Footer,{className:"modal-header-footer"},r.a.createElement(y.a,{className:"modal-button",onClick:this.handleClose},"Cerrar"))))}}]),t}(r.a.Component),k=Object(f.a)(O),U=a(79),B=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleLogout=function(e){a.props.logout()},a.editUser=function(){return a.service.put("/editUser/".concat(a.state.loggedInUser._id))},a.state={loggedInUser:null},a.service=new g,a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState(Object(U.a)({},this.state,{loggedInUser:e.userInSession}))}},{key:"render",value:function(){return this.state.loggedInUser?r.a.createElement("nav",{className:"navbar"},r.a.createElement("div",{className:"avatar"},r.a.createElement("img",{src:this.state.loggedInUser.avatarPath,alt:""})),r.a.createElement("h1",null,this.state.loggedInUser.username),r.a.createElement(w.a,{to:"/"},r.a.createElement("button",{onClick:this.handleLogout},"Log out")),r.a.createElement(w.a,{to:"/board"},r.a.createElement("button",null,"Ve al mercado")),r.a.createElement(w.a,{to:"/profile"},r.a.createElement("button",null,"Ve a tu perfil"))):r.a.createElement("div",null,r.a.createElement("nav",{className:"navbar"},r.a.createElement(w.a,{to:"/signup"},r.a.createElement("button",null,"Sign up")),r.a.createElement(w.a,{to:"/login"},r.a.createElement("button",null,"Log in"))))}}]),t}(r.a.Component),x=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleInputChange=function(e){a.setState({stringToSearch:e.target.value})},a.handleSubmit=function(){var e=a.state.stringToSearch;a.props.submitSearch(e)},a.state={stringToSearch:""},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.stringToSearch;return r.a.createElement("div",{className:"searchbar-container"},r.a.createElement("input",{className:"searchbar-input",placeholder:"\xbfQu\xe9 juego quieres buscar?",type:"text",value:t,onChange:function(t){return e.handleInputChange(t)}}),r.a.createElement("button",{className:"searchbar-button",onClick:function(){return e.handleSubmit()}},"Busca juegos!"))}}]),t}(r.a.Component),P=function e(){var t=this;Object(s.a)(this,e),this.findProfileItems=function(){return t.service.get("/profile").then(function(e){return e.data})},this.deleteItem=function(e){return t.service.post("/delete",{itemId:e}).then(function(e){return e.data})},this.searchItems=function(e){return t.service.post("/searchItems",{stringToSearch:e}).then(function(e){return e.data})},this.searchGames=function(e){return t.service.post("/searchGames",{stringToSearch:e}).then(function(e){return e.data})},this.addItem=function(e,a,n,r,l){return t.service.post("/addItem",{name:e,yearpublished:a,image_url:n,price:r,condition:l}).then(function(e){return e.data})},this.followItem=function(e){return t.service.post("/followItem",{itemId:e}).then(function(e){return e.data})},this.unfollowItem=function(e){return t.service.post("/unfollowItem",{itemId:e}).then(function(e){return e.data})},this.service=E.a.create({baseURL:"".concat("https://board-game-market.herokuapp.com/api","/item"),withCredentials:!0})},M=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleShow=a.handleShow.bind(Object(b.a)(Object(b.a)(a))),a.handleClose=a.handleClose.bind(Object(b.a)(Object(b.a)(a))),a.state={show:!1,owned:!1,followed:!1,itemId:a.props.itemInfo._id},a.service=new P,a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"handleDate",value:function(){var e=this.props.itemInfo.created_at.slice(0,10),t=e.substr(0,4),a=e.substr(5,2);return e.substr(8,2)+"-"+a+"-"+t}},{key:"componentDidMount",value:function(){if(this.props.userInfo){var e=this.props.itemInfo.ownerUser.username,t=this.props.userInfo.username,a=this.state.itemId,n=this.props.userInfo.followedItems;e===t&&this.setState({owned:!0}),n.includes(a)&&this.setState({followed:!0})}}},{key:"followedOrNot",value:function(){var e=this,t=this.state.owned,a=this.state.followed,n=this.props.itemInfo.ownerUser.username,l=this.props.profile;return!t&!a?r.a.createElement("div",null,r.a.createElement("p",null,"Propietario: ",n),r.a.createElement("button",{className:"modal-itemchange-button",onClick:function(){return e.followItem()}},"Seguir Juego")):!t&a?r.a.createElement("div",null,r.a.createElement("p",null,"Propietario: ",n),r.a.createElement("button",{className:"modal-itemchange-button",onClick:function(){return e.unfollowItem()}},"Dejar de seguir")):t&!l?r.a.createElement("p",null,"El juego es tuyo!"):void 0}},{key:"beAbleToDelete",value:function(){if(this.props.profile)return r.a.createElement("button",{className:"modal-itemchange-button",onClick:this.props.deleteItem},"Quita este juego de la venta")}},{key:"followItem",value:function(){var e=this,t=this.state.itemId;this.service.followItem(t).then(function(t){e.setState({followed:!0})}).then(function(){e.props.handleChanges()}).catch(function(e){return alert("Inicia sesi\xf3n para poder seguir")})}},{key:"unfollowItem",value:function(){var e=this,t=this.state.itemId;this.service.unfollowItem(t).then(function(t){e.setState({followed:!1})}).then(function(){e.props.handleChanges()}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){var e=this.props.itemInfo,t=e.name,a=e.yearpublished,n=e.condition,l=e.price,o=e.image_url,s=this.handleDate();return r.a.createElement("div",null,r.a.createElement(y.a,{className:"modal-item-button",bsStyle:"primary",bsSize:"large",onClick:this.handleShow},"Ver m\xe1s"),r.a.createElement(N.a,{show:this.state.show,onHide:this.handleClose,className:"modal-main",bsSize:"large"},r.a.createElement(N.a.Header,{className:"modal-header-footer",closeButton:!0},r.a.createElement(N.a.Title,{className:"modal-itemheader-text"},t)),r.a.createElement(N.a.Body,{className:"modal-body item-container"},r.a.createElement("div",{className:"item-img"},r.a.createElement("img",{src:o,alt:t,width:"250px"})),r.a.createElement("div",{className:"item-info"},r.a.createElement("p",{className:"item-price"},"Precio: ",l," \u20ac"),r.a.createElement("p",null,"Estado: ",n),r.a.createElement("p",null,"A\xf1o de Publicaci\xf3n: ",a),r.a.createElement("p",null,"Puesto a la venta: ",s),this.beAbleToDelete(),this.followedOrNot())),r.a.createElement(N.a.Footer,{className:"modal-header-footer"},r.a.createElement(y.a,{className:"modal-item-button",onClick:this.handleClose},"Cerrar"))))}}]),t}(r.a.Component),T=function(e){var t=e.itemInfo.created_at.slice(0,10),a=t.substr(0,4),n=t.substr(5,2),l=t.substr(8,2)+"-"+n+"-"+a;return r.a.createElement("div",{className:"littleitem-container"},r.a.createElement("div",{className:"littleitem-left"},r.a.createElement("h4",null," ",e.itemInfo.name),r.a.createElement("div",{className:"item-img"},r.a.createElement("img",{src:e.itemInfo.image_url,alt:e.itemInfo.name,width:"100px"}))),r.a.createElement("div",{className:"littleitem-right"},r.a.createElement("p",{className:"price"},e.itemInfo.price," \u20ac"),r.a.createElement("p",null,"Publicado el: ",l),r.a.createElement(M,{itemInfo:e.itemInfo,userInfo:e.userInfo,deleteItem:function(){var t=e.itemInfo._id;e.deleteItem(t)},profile:e.profile,handleChanges:function(){return e.handleChanges()}})))},G=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).getItems=function(e){return a.service.searchItems(e).then(function(e){a.setState({results:e})}).catch(function(e){return console.log(e)})},a.state={results:[]},a.service=new P,a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){this.getItems("")}},{key:"render",value:function(){var e=this,t=this.state.results,a=this.props.userInfo;return r.a.createElement("div",{className:"big-container"},r.a.createElement(x,{submitSearch:function(t){return e.getItems(t)}}),r.a.createElement("div",{className:"littleitems-board"},t.map(function(t,n){return r.a.createElement(T,{itemInfo:t,key:n,userInfo:a,handleChanges:function(){return e.componentWillMount()}})})))}}]),t}(r.a.Component),A=function(){return r.a.createElement("div",{className:"home-container"},r.a.createElement("h2",{className:"home-header"},"Bienvenido a Board Game Market"),r.a.createElement("div",{className:"button-container"},r.a.createElement(w.a,{to:"/board"},r.a.createElement("button",{className:""},r.a.createElement("p",null," Ve al mercado para ver qu\xe9 juegos hay a la venta. ")))))},_=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleFormSubmit=function(e){e.preventDefault();var t=a.state,n=t.name,r=t.yearpublished,l=t.image_url,o=t.price,s=t.condition;a.service.addItem(n,r,l,o,s).then(function(){return a.props.history.push("/profile")}).catch(function(e){return console.log(e)})},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(p.a)({},n,r))},a.state={name:a.props.name,yearpublished:a.props.yearpublished,image_url:a.props.image_url,price:"",condition:""},a.service=new P,a.handleShow=a.handleShow.bind(Object(b.a)(Object(b.a)(a))),a.handleClose=a.handleClose.bind(Object(b.a)(Object(b.a)(a))),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"handleClose",value:function(){this.setState({show:!1})}},{key:"handleShow",value:function(){this.setState({show:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(y.a,{className:"modal-item-button",bsStyle:"primary",bsSize:"large",onClick:this.handleShow},"A\xf1adir"),r.a.createElement(N.a,{show:this.state.show,onHide:this.handleClose,className:"modal-main",bsSize:"large"},r.a.createElement(N.a.Header,{className:"modal-header-footer",closeButton:!0},r.a.createElement(N.a.Title,{className:"modal-header-text"},"A\xf1ade las opciones para tu juego")),r.a.createElement(N.a.Body,{className:"modal-body"},r.a.createElement("div",null,r.a.createElement("form",{className:"modal-body",onSubmit:this.handleFormSubmit},r.a.createElement("fieldset",null,r.a.createElement("label",null,"Precio:"),r.a.createElement("input",{type:"text",name:"price",value:this.state.price,onChange:function(t){return e.handleChange(t)}})),r.a.createElement("fieldset",null,r.a.createElement("label",null,"Estado:"),r.a.createElement("select",{name:"condition",onChange:function(t){return e.handleChange(t)}},r.a.createElement("option",{selected:!0,value:"Elige una opci\xf3n"},"Elige una opci\xf3n"),r.a.createElement("option",{value:"Nuevo"},"Nuevo"),r.a.createElement("option",{value:"Como Nuevo"},"Como Nuevo"),r.a.createElement("option",{value:"Muy Bueno"},"Muy Bueno"),r.a.createElement("option",{value:"Bueno"},"Bueno"),r.a.createElement("option",{value:"Normal"},"Normal"),r.a.createElement("option",{value:"Malo"},"Malo"))),r.a.createElement("input",{type:"submit",value:"A\xf1ade juego a la venta",className:"modal-button"})))),r.a.createElement(N.a.Footer,{className:"modal-header-footer"},r.a.createElement(y.a,{className:"modal-button",onClick:this.handleClose},"Cerrar"))))}}]),t}(r.a.Component),D=Object(f.a)(_),F=function(e){var t=e.gameInfo,a=t.yearpublished,n=t.image_url,l=e.gameInfo.name.text;return r.a.createElement("div",{className:"littleitem-container"},r.a.createElement("div",{className:"littleitem-left"},r.a.createElement("div",{className:"item-img"},r.a.createElement("h4",null," ",l),r.a.createElement("img",{src:n,alt:l,width:"100px"}))),r.a.createElement("div",{className:"littleitem-right"},r.a.createElement("p",null,"A\xf1o de publicaci\xf3n: ",a),r.a.createElement(D,{name:l,yearpublished:a,image_url:n,addedGame:function(){e.addedGame()}})))},R=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).searchGames=function(e){return a.setState({tooMuchResults:!1,results:[]}),a.service.searchGames(e).then(function(e){e.length>=60?a.setState({tooMuchResults:!0}):a.setState({results:e,tooMuchResults:!1})}).catch(function(e){return console.log(e)})},a.state={ownedItems:[],followedItems:[],results:[],tooMuchResults:!1,profile:!0},a.service=new P,a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.findProfileItems()}},{key:"findProfileItems",value:function(){var e=this;this.service.findProfileItems().then(function(t){e.setState({ownedItems:t.ownedList,followedItems:t.followedList.followedItems})}).catch(function(e){return console.log(e)})}},{key:"deleteItem",value:function(e){var t=this;this.service.deleteItem(e).then(function(e){t.findProfileItems()}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){var e=this,t=this.state,a=t.ownedItems,n=t.followedItems,l=t.results,o=t.tooMuchResults,s=this.props.userInfo,i=this.state.profile;return r.a.createElement("div",{className:"big-container"},r.a.createElement("div",{className:"profile-searchbar"},r.a.createElement("h3",null,"Busca un juego para poner a la venta"),r.a.createElement(x,{submitSearch:function(t){return e.searchGames(t)}}),o?r.a.createElement("p",null,"Demasiados resultados, restringe m\xe1s tu b\xfasqueda"):r.a.createElement("div",{className:"littleitems-board"},l.map(function(e,t){return r.a.createElement(F,{gameInfo:e,key:t})}))),r.a.createElement("h3",null,"Juegos que tienes a la venta:"),r.a.createElement("div",{className:"littleitems-board"},a.map(function(t,a){return r.a.createElement(T,{itemInfo:t,key:a,userInfo:s,deleteItem:function(t){return e.deleteItem(t)},profile:i})})),r.a.createElement("h3",null,"Juegos que sigues:"),r.a.createElement("div",{className:"littleitems-board"},n.map(function(t,a){return r.a.createElement(T,{itemInfo:t,key:a,userInfo:s,handleChanges:function(){return e.findProfileItems()}})})))}}]),t}(r.a.Component),H=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(u.a)(t).call(this,e))).getTheUser=function(e){a.setState({loggedInUser:e})},a.logout=function(){a.service.logout().then(function(){a.setState({loggedInUser:null})}).then(function(){a.props.history.push("/")})},a.state={loggedInUser:null},a.service=new g,a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"fetchUser",value:function(){var e=this;null===this.state.loggedInUser&&this.service.loggedin().then(function(t){e.setState({loggedInUser:t})}).catch(function(t){e.setState({loggedInUser:!1})})}},{key:"render",value:function(){var e=this;return this.fetchUser(),this.state.loggedInUser?r.a.createElement("div",null,r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(B,{userInSession:this.state.loggedInUser,logout:this.logout})),r.a.createElement("div",{className:"main-container"},r.a.createElement(h.a,null,r.a.createElement(d.a,{exact:!0,path:"/profile",component:function(){return r.a.createElement(R,{userInfo:e.state.loggedInUser})}}),r.a.createElement(d.a,{exact:!0,path:"/board",component:function(){return r.a.createElement(G,{userInfo:e.state.loggedInUser})}}))),r.a.createElement("footer",{className:"App-footer"},r.a.createElement("p",null,"\xa92018 Board Game Market"),r.a.createElement("p",null,"Powered by Board Game Geek")))):r.a.createElement("div",null,r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(B,{userInSession:this.state.loggedInUser,logout:this.logout})),r.a.createElement("div",{className:"main-container"},r.a.createElement(h.a,null,r.a.createElement(d.a,{exact:!0,path:"/",component:A}),",",r.a.createElement(d.a,{exact:!0,path:"/signup",component:function(){return r.a.createElement(C,{getUser:e.getTheUser})}}),",",r.a.createElement(d.a,{exact:!0,path:"/login",component:function(){return r.a.createElement(k,{getUser:e.getTheUser})}}),",",r.a.createElement(d.a,{exact:!0,path:"/board",component:G}))),r.a.createElement("footer",{className:"App-footer"},r.a.createElement("p",null,"\xa92018 Board Game Market"),r.a.createElement("p",null,"Powered by Board Game Geek"))))}}]),t}(r.a.Component),L=Object(f.a)(H),z=a(192);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(z.a,null,r.a.createElement(L,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},51:function(e,t,a){},80:function(e,t,a){e.exports=a(189)}},[[80,2,1]]]);
//# sourceMappingURL=main.f63a8e89.chunk.js.map